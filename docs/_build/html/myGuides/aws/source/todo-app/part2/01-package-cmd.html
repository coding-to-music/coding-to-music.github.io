

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Section 1: chalice package command &mdash; all-knowledge</title>
  

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/tooltipster.custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/tooltipster.bundle.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/tooltipster-sideTip-shadow.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/tooltipster-sideTip-punk.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/tooltipster-sideTip-noir.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/tooltipster-sideTip-light.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/tooltipster-sideTip-borderless.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/micromodal.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/sphinx_rtd_theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/contentui.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/gallery-rendered-html.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2/css/lightbox.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
  

  
  

  
    <link rel="canonical" href="https://pandemic-overview.readthedocs.io/en/latest/myGuides/aws/source/todo-app/part2/01-package-cmd.html" />

  
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/language_data.js"></script>
        <script src="../../../../../_static/clipboard.min.js"></script>
        <script src="../../../../../_static/copybutton.js"></script>
        <script src="../../../../../_static/js/hoverxref.js"></script>
        <script src="../../../../../_static/js/tooltipster.bundle.min.js"></script>
        <script src="../../../../../_static/js/micromodal.min.js"></script>
        <script src="../../../../../_static/tabs.js"></script>
        <script src="../../../../../_static/js/expand_tabs.js"></script>
        <script src="../../../../../_static/contentui.js"></script>
        <script src="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
        <script src="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
        <script src="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="Section 2: Working with AWS CodePipeline" href="02-pipeline.html" />
    <link rel="prev" title="Part 2: Deployment and setting up a CICD pipeline with AWS Chalice" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html">
          

          
            
            <img src="../../../../../_static/statsmodels-logo-v2-bw.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Covid-Medical-Treatments/Covid-Medical-Treatments.html">Covid Medical Treatments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Bill-Gates-Memes/Bill-Gates-Memes.html">Bill Gates Memes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/topics.html">Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Data-science-of-the-pandemic/Data-science-of-the-pandemic.html">Data Science of the Pandemic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Vaccines/Vaccines.html">Vaccines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Masks/Masks.html">Masks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Lockdowns/Lockdowns.html">Lockdowns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Origins-of-the-Virus/Origins-of-the-Virus.html">Origins of the Virus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Pandemic-Preparedness/Pandemic-Preparedness.html">Pandemic Preparedness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Pandemic-Participants/Pandemic-Participants.html">Pandemic Participants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Food-Safety/Food-Safety.html">Food Safety</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Municipal-Matters/Municipal-Matters.html">Municipal Issues and Topics</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../../How-you-can-help/How-you-can-help.html">How you can help</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../Tech-stack-for-this-website.html">Tech stack for this website</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../myGuides.html">My Guides for Various Technical Topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../General-computer-setup.html">General Computer Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Advanced-Computer-Setup.html">Advanced Computer Setup and Topics</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../Amazon-AWS-Learning.html">Amazon AWS Learning</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">AWS Chalice Workshop</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../env-setup.html">Prerequisite: Setting up your environment</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../index.html">Todo Application</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../media-query/index.html">Media Query Application</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../code/media-query/final/README.html">Media Query Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../code/todo-app/final/README.html">My Todo App</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../code/todo-app/part1/README.html">Chalice Workshop Code Part 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../code/todo-app/part2/README.html">Chalice Workshop Part 2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ToDo-project-tasks.html">ToDo project and documentation tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Contribute.html">Contribute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Upcoming-software-to-try.html">Links of Upcoming Software to Try</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../How-you-can-help/Links-to-add-to-site.html">Links to add to the documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../How-you-can-help/Future-topics-to-be-developed.html">Future Topics to be developed</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Sandbox/Sandbox.html">Sandbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../License/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Help-about/help.html">Help - About</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Covid-Medical-Treatments/Covid-Medical-Treatments.html">Covid Medical Treatments</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Bill-Gates-Memes/Bill-Gates-Memes.html">Bill Gates Memes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/topics.html">Topics</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Data-science-of-the-pandemic/Data-science-of-the-pandemic.html">Data Science of the Pandemic</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Vaccines/Vaccines.html">Vaccines</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Masks/Masks.html">Masks</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Lockdowns/Lockdowns.html">Lockdowns</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Origins-of-the-Virus/Origins-of-the-Virus.html">Origins of the Virus</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Pandemic-Preparedness/Pandemic-Preparedness.html">Pandemic Preparedness</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Pandemic-Participants/Pandemic-Participants.html">Pandemic Participants</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Food-Safety/Food-Safety.html">Food Safety</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../topics/Municipal-Matters/Municipal-Matters.html">Municipal Issues and Topics</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../../../How-you-can-help/How-you-can-help.html">How you can help</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../Tech-stack-for-this-website.html">Tech stack for this website</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../myGuides.html">My Guides for Various Technical Topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../General-computer-setup.html">General Computer Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Advanced-Computer-Setup.html">Advanced Computer Setup and Topics</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../Amazon-AWS-Learning.html">Amazon AWS Learning</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html">AWS Chalice Workshop</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../env-setup.html">Prerequisite: Setting up your environment</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../index.html">Todo Application</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../media-query/index.html">Media Query Application</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../code/media-query/final/README.html">Media Query Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../code/todo-app/final/README.html">My Todo App</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../code/todo-app/part1/README.html">Chalice Workshop Code Part 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../code/todo-app/part2/README.html">Chalice Workshop Part 2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ToDo-project-tasks.html">ToDo project and documentation tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Contribute.html">Contribute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Upcoming-software-to-try.html">Links of Upcoming Software to Try</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../How-you-can-help/Links-to-add-to-site.html">Links to add to the documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../How-you-can-help/Future-topics-to-be-developed.html">Future Topics to be developed</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">all-knowledge</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../../../How-you-can-help/How-you-can-help.html">How you can help</a> &raquo;</li>
        
          <li><a href="../../../Amazon-AWS-Learning.html">Amazon AWS Learning</a> &raquo;</li>
        
          <li><a href="../../index.html">AWS Chalice Workshop</a> &raquo;</li>
        
          <li><a href="../index.html">Todo Application</a> &raquo;</li>
        
          <li><a href="index.html">Part 2:  Deployment and setting up a CICD pipeline with AWS Chalice</a> &raquo;</li>
        
      <li>Section 1: <code class="docutils literal notranslate"><span class="pre">chalice</span> <span class="pre">package</span></code> command</li>
    
    
    <li class="wy-breadcrumbs-aside">
    
        
        
            <a href="https://github.com/coding-to-music/coding-to-music//master/source/myGuides/aws/source/todo-app/part2/01-package-cmd.rst" class="btn btn-neutral" title="Edit Page on GitHub" rel="Edit Page on GitHub"><span style="padding-left: 0.5em" >Edit on<i style="margin-left: 0.5em" class="fa fa-github"></i></span></a>
            <a href="https://github.com/coding-to-music/coding-to-music/commits/master/source/myGuides/aws/source/todo-app/part2/01-package-cmd.rst" class="btn btn-neutral" title="Page History" rel="Page History"><span class="fa fa-clock-o"></span></a>
            <a href="https://github.com/coding-to-music/coding-to-music/blame/master/source/myGuides/aws/source/todo-app/part2/01-package-cmd.rst" class="btn btn-neutral" title="Page Contributors" rel="Page Contributors"><span class="fa fa-users"></span></a>
        
        
    
    </li>

  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="02-pipeline.html" class="btn btn-neutral float-right" title="Section 2: Working with AWS CodePipeline" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Part 2: Deployment and setting up a CICD pipeline with AWS Chalice" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
<div itemprop="articleBody">

<nav id="local-table-of-contents" role="navigation" aria-labelledby="local-table-of-contents-title">
    <h4 id="local-table-of-contents-title">On This Page</h4>
    <ul>
<li><a class="reference internal" href="#">Section 1: <code class="docutils literal notranslate"><span class="pre">chalice</span> <span class="pre">package</span></code> command</a><ul>
<li><a class="reference internal" href="#initial-setup">Initial Setup</a><ul>
<li><a class="reference internal" href="#instructions">Instructions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#create-a-sam-template">Create a SAM template</a><ul>
<li><a class="reference internal" href="#id1">Instructions</a></li>
<li><a class="reference internal" href="#verification">Verification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deploy-your-sam-template">Deploy your SAM template</a><ul>
<li><a class="reference internal" href="#id2">Instructions</a></li>
<li><a class="reference internal" href="#id3">Verification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#update-your-app">Update your app</a><ul>
<li><a class="reference internal" href="#id4">Instructions</a></li>
<li><a class="reference internal" href="#id5">Verification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#delete-your-stack">Delete your stack</a><ul>
<li><a class="reference internal" href="#id6">Instructions</a></li>
<li><a class="reference internal" href="#id7">Verification</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</nav>


  <section id="section-1-chalice-package-command">
<h1>Section 1: <code class="docutils literal notranslate"><span class="pre">chalice</span> <span class="pre">package</span></code> command<a class="headerlink" href="#section-1-chalice-package-command" title="Permalink to this headline">¶</a></h1>
<p>In this section, we’ll use the <code class="docutils literal notranslate"><span class="pre">chalice</span> <span class="pre">package</span></code> command
to learn about the AWS CloudFormation integration with AWS chalice.</p>
<section id="initial-setup">
<h2>Initial Setup<a class="headerlink" href="#initial-setup" title="Permalink to this headline">¶</a></h2>
<p>We’ll take our existing Todo app and create a SAM template.</p>
<section id="instructions">
<h3>Instructions<a class="headerlink" href="#instructions" title="Permalink to this headline">¶</a></h3>
<p>The starting code for this step is in
<code class="docutils literal notranslate"><span class="pre">code/todo-app/part2/01-package-cmd</span></code>.  You can reuse your existing
sample application from part1 of this workshop.  If necessary,
you can copy over these files as a starting point for this
section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cp ../chalice-workshop/code/todo-app/part2/01-package-cmd/*.py .
$ cp ../chalice-workshop/code/todo-app/part2/01-package-cmd/chalicelib/*.py chalicelib/
$ cp ../chalice-workshop/code/todo-app/part2/01-package-cmd/.chalice/policy-dev.json .chalice/policy-dev.json
</pre></div>
</div>
<p>Now we’re going to deploy our app using a CloudFormation stack.</p>
<ol class="arabic">
<li><p>First, ensure you have the AWS CLI installed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ aws --version
aws-cli/1.11.171 Python/2.7.14 Darwin/16.7.0 botocore/1.7.29
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><p>If the AWS CLI is not installed, you can follow the instructions
in the <a class="reference internal" href="../../env-setup.html#aws-cli-setup"><span class="std std-ref">Setting up AWS credentials</span></a> section.</p>
</div></blockquote>
</section>
</section>
<section id="create-a-sam-template">
<h2>Create a SAM template<a class="headerlink" href="#create-a-sam-template" title="Permalink to this headline">¶</a></h2>
<p>In this step, we’re going to create a SAM template
using the <code class="docutils literal notranslate"><span class="pre">chalice</span> <span class="pre">package</span></code> command.</p>
<section id="id1">
<h3>Instructions<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>Create a SAM template for your app by using the <code class="docutils literal notranslate"><span class="pre">chalice</span> <span class="pre">package</span></code>
command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ chalice package packaged/
</pre></div>
</div>
</li>
</ol>
</section>
<section id="verification">
<h3>Verification<a class="headerlink" href="#verification" title="Permalink to this headline">¶</a></h3>
<p>You should see two files in the <code class="docutils literal notranslate"><span class="pre">packaged/</span></code> directory, a
deployment zip file as well as a SAM template.</p>
<ol class="arabic">
<li><p>Verify the contents of the <code class="docutils literal notranslate"><span class="pre">packaged/</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls -la packaged/
.
..
deployment.zip
sam.json
</pre></div>
</div>
</li>
<li><p>Verify the contents of the <code class="docutils literal notranslate"><span class="pre">deployment.zip</span></code>.  You should
see your app.py file along with all the python library
dependencies needed to run your app.  Chalice automatically
handles managing dependencies based on your <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code>
file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ unzip -l packaged/deployment.zip
Archive:  packaged/deployment.zip
  Length      Date    Time    Name
---------  ---------- -----   ----
    31920  10-11-2017 16:28   chalice/app.py
      431  10-10-2017 11:40   chalice/__init__.py
      237  10-24-2017 11:30   app.py
            ...
     1159  10-24-2017 10:17   chalicelib/auth.py
     3647  10-24-2017 10:17   chalicelib/db.py
---------                     -------
</pre></div>
</div>
</li>
<li><p>Verify the contents of the <code class="docutils literal notranslate"><span class="pre">sam.json</span></code> file.  You don’t have to
understand the specifics of this file, but you’ll notice that
there’s a few serverless resources defined:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ grep -B 1 &#39;Serverless::&#39; packaged/sam.json
    &quot;RestAPI&quot;: {
      &quot;Type&quot;: &quot;AWS::Serverless::Api&quot;,
--
    &quot;APIHandler&quot;: {
      &quot;Type&quot;: &quot;AWS::Serverless::Function&quot;,
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="deploy-your-sam-template">
<h2>Deploy your SAM template<a class="headerlink" href="#deploy-your-sam-template" title="Permalink to this headline">¶</a></h2>
<section id="id2">
<h3>Instructions<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Next, we’ll use the AWS CLI to deploy our application through
AWS CloudFormation.</p>
<ol class="arabic">
<li><p><code class="docutils literal notranslate"><span class="pre">cd</span></code> to the <code class="docutils literal notranslate"><span class="pre">packaged</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd packaged/
$ ls -la
.
..
deployment.zip
sam.json
</pre></div>
</div>
</li>
<li><p>Next you’ll need to create an Amazon S3 bucket.  When deploying
your application with CloudFormation, your code is uploaded to
an S3 bucket.  We can use the AWS CLI to create an S3 bucket.
Keep in mind that S3 buckets are globally unique, so you’ll need
to use your own bucket name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ aws s3 mb s3://chalice-workshop-cfn-bucket/ --region us-west-2
</pre></div>
</div>
</li>
<li><p>Use the AWS CLI to package your code.  This will upload your
code to the S3 bucket you’ve created and create a new SAM
template that references your S3 object. Make sure to use the
same bucket you used in the previous step for the value of
the <code class="docutils literal notranslate"><span class="pre">--s3-bucket</span></code> option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ aws cloudformation package --template-file ./sam.json \
    --s3-bucket chalice-workshop-cfn-bucket \
    --output-template-file sam-packaged.yaml
</pre></div>
</div>
</li>
<li><p>Deploy your application using the AWS CLI.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ aws cloudformation deploy --template-file ./sam-packaged.yaml \
    --stack-name chalice-beta-stack \
    --capabilities CAPABILITY_IAM
</pre></div>
</div>
<p>This command will take a few minutes to execute.  When this command
finishes, you’re chalice app will be up and running.</p>
</li>
</ol>
</section>
<section id="id3">
<h3>Verification<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>Verify that the stack creation was successful:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ aws cloudformation describe-stacks --stack-name chalice-beta-stack \
    --query &#39;Stacks[0].StackStatus&#39;
&quot;CREATE_COMPLETE&quot;
</pre></div>
</div>
</li>
<li><p>Query the stack outputs to retrieve the endpoint URL of your
REST API:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ aws cloudformation describe-stacks --stack-name chalice-beta-stack \
    --query &#39;Stacks[0].Outputs&#39;
[
    {
        &quot;OutputKey&quot;: &quot;APIHandlerArn&quot;,
        &quot;OutputValue&quot;: &quot;arn:aws:lambda:us-west-2:123:function:...&quot;
    },
    {
        &quot;OutputKey&quot;: &quot;APIHandlerName&quot;,
        &quot;OutputValue&quot;: &quot;...&quot;
    },
    {
        &quot;OutputKey&quot;: &quot;RestAPIId&quot;,
        &quot;OutputValue&quot;: &quot;abcd&quot;
    },
    {
        &quot;OutputKey&quot;: &quot;EndpointURL&quot;,
        &quot;OutputValue&quot;: &quot;https://your-chalice-url/api/&quot;
    }
]
</pre></div>
</div>
</li>
<li><p>Use the value for <code class="docutils literal notranslate"><span class="pre">EndpointURL</span></code> to test your API by creating
a new Todo item:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ echo &#39;{&quot;description&quot;: &quot;My third Todo&quot;, &quot;metadata&quot;: {}}&#39; | \
    http POST https://your-chalice-url/api/todos
HTTP/1.1 200 OK
Content-Length: 36
Content-Type: application/json

abcdefg-abcdefg
</pre></div>
</div>
</li>
<li><p>Verify you can retrieve this item:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ http https://your-chalice-url/todos/abcdefg-abcdefg
HTTP/1.1 200 OK
Content-Length: 140
Content-Type: application/json

{
    &quot;description&quot;: &quot;My third Todo&quot;,
    &quot;metadata&quot;: {},
    &quot;state&quot;: &quot;unstarted&quot;,
    &quot;uid&quot;: &quot;abcdefg-abcdefg&quot;,
    &quot;username&quot;: &quot;default&quot;
}
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="update-your-app">
<h2>Update your app<a class="headerlink" href="#update-your-app" title="Permalink to this headline">¶</a></h2>
<p>Now we’ll make a change and deploy our change.</p>
<section id="id4">
<h3>Instructions<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>At the bottom of the <code class="docutils literal notranslate"><span class="pre">app.py</span></code> file, add a test route:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/test-route&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">test_route</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;test&#39;</span><span class="p">:</span> <span class="s1">&#39;route&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Now we’re going to use chalice and the AWS CLI to deploy
this change.  Make sure you’re at the top level directory
of your app (the app.py should be in your current working
directory).  Run the <code class="docutils literal notranslate"><span class="pre">chalice</span> <span class="pre">package</span></code> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls -la
...
app.py
$ chalice package packaged/
</pre></div>
</div>
</li>
<li><p>Run the <code class="docutils literal notranslate"><span class="pre">aws</span> <span class="pre">cloudformation</span> <span class="pre">package</span></code> command.  This will
re-upload your code to S3.  Be sure to use the same
bucket name you used in the previous step:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd packaged/
$ aws cloudformation package --template-file ./sam.json \
    --s3-bucket chalice-workshop-cfn-bucket \
    --output-template-file sam-packaged.yaml
</pre></div>
</div>
</li>
<li><p>Deploy your application using the AWS CLI:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ aws cloudformation deploy --template-file ./sam-packaged.yaml \
    --stack-name chalice-beta-stack \
    --capabilities CAPABILITY_IAM
</pre></div>
</div>
</li>
</ol>
</section>
<section id="id5">
<h3>Verification<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>Verify that the stack update was successful:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ aws cloudformation describe-stacks --stack-name chalice-beta-stack \
    --query &#39;Stacks[0].StackStatus&#39;
</pre></div>
</div>
</li>
<li><p>Verify the new test route is available.  Use the same
<code class="docutils literal notranslate"><span class="pre">EndpointURL</span></code> from the previous step:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ http https://your-chalice-url/api/test-route
HTTP/1.1 200 OK
Content-Length: 140
Content-Type: application/json

{&quot;test&quot;: &quot;route&quot;}
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="delete-your-stack">
<h2>Delete your stack<a class="headerlink" href="#delete-your-stack" title="Permalink to this headline">¶</a></h2>
<p>We no longer need this CloudFormation stack.  In the next
section we’ll use AWS CodePipeline to manage this CloudFormation
stack, so we can delete our existing stack.  Rather that
use <code class="docutils literal notranslate"><span class="pre">chalice</span> <span class="pre">delete</span></code>, we’re going to use the AWS CLI to delete
the CloudFormation stack we’ve created.</p>
<section id="id6">
<h3>Instructions<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>Delete your CloudFormation stack:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ aws cloudformation delete-stack --stack-name chalice-beta-stack
</pre></div>
</div>
</li>
<li><p>Wait for the deletion to successfully complete:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ aws cloudformation wait stack-delete-complete \
    --stack-name chalice-beta-stack
</pre></div>
</div>
</li>
<li><p>Delete the S3 bucket you’ve created.  Be sure to use the
same bucket name you used when you created the bucket:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ aws s3 rb --force s3://chalice-workshop-cfn-bucket/ \
    --region us-west-2
</pre></div>
</div>
</li>
</ol>
</section>
<section id="id7">
<h3>Verification<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p>Verify the stack status:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ aws cloudformation describe-stacks --stack-name chalice-beta-stack \
    --query &#39;Stacks[0].StackStatus&#39;
</pre></div>
</div>
</li>
<li><p>Verify the <code class="docutils literal notranslate"><span class="pre">EndpointURL</span></code> is no longer accessible:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ http https://your-chalice-url/api/test-route

http: error: SSLError: [SSL: SSLV3_ALERT_HANDSHAKE_FAILURE] sslv3 alert
handshake failure (_ssl.c:590) while doing GET request to URL:
https://your-chalice-url/api/test-route
</pre></div>
</div>
</li>
</ol>
</section>
</section>
</section>


</div>

</div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="02-pipeline.html" class="btn btn-neutral float-right" title="Section 2: Working with AWS CodePipeline" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Part 2: Deployment and setting up a CICD pipeline with AWS Chalice" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020-2021, Thomas Connors and Contributors.
      <span class="lastupdated">
        Last updated on Sat, 17 Jul 2021 12:00 AM .
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>